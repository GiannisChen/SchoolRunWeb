<!DOCTYPE html>
<!-- saved from url=(0052)http://getbootstrap.com/docs/4.0/examples/dashboard/ -->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>“校园跑”微信小程序后台</title>
    <!-- Bootstrap core CSS -->
    <link href="asserts/css/bootstrap.min.css" th:href="@{/webjars/bootstrap/4.5.2/css/bootstrap.css}" rel="stylesheet">
	<link href="asserts/css/dashboard.css" th:href="@{/asserts/css/dashboard.css}" rel="stylesheet">

</head>
<style type="text/css">
	.myTable-container {
		width: 100%;
		height: 250px;
	}
</style>
<body>
<!--引入topbar-->
<div th:replace="commons/bar::topbar"></div>
<div class="container-fluid">
    <div class="row">
        <!--引入sidebar-->
        <div th:replace="commons/bar::#sidebar(activeUri='dashboard.html')"></div>
        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
			<div class="container-fluid">
				<section id="main-content">

					<div class="row">
						<div class="col-lg-3">
							<div class="card">
								<!-- Custom styles for this template -->
								<link href="asserts/css/style.css" rel="stylesheet">
								<div class="stat-widget-two">
									<div class="stat-content">
										<div class="stat-text">今日打卡（人）</div>
										<div class="stat-digit" th:text="${details.getPostDailyNum()}">--</div>
									</div>
									<div class="progress">
										<div class="progress-bar progress-bar-success w-50" role="progressbar" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3">
							<div class="card">
								<div class="stat-widget-two">
									<div class="stat-content">
										<div class="stat-text">今日体能（人）</div>
										<div class="stat-digit" th:text="${details.getTraceDailyNum()}">--</div>
									</div>
									<div class="progress">
										<div class="progress-bar progress-bar-primary w-50" role="progressbar" aria-valuenow="78" aria-valuemin="0" aria-valuemax="100"></div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3">
							<div class="card">
								<div class="stat-widget-two">
									<div class="stat-content">
										<div class="stat-text">打卡总计（人次）</div>
										<div class="stat-digit" th:text="${details.getPostTotalNum()}">--</div>
									</div>
									<div class="progress">
										<div class="progress-bar progress-bar-warning w-50" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-3">
							<div class="card">
								<div class="stat-widget-two">
									<div class="stat-content">
										<div class="stat-text">体能总计（人次）</div>
										<div class="stat-digit" th:text="${details.getTraceTotalNum()}">--</div>
									</div>
									<div class="progress">
										<div class="progress-bar progress-bar-danger w-50" role="progressbar" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div>
									</div>
								</div>
							</div>
							<!-- /# card -->
						</div>
						<!-- /# column -->
					</div>
					<div class="row">
						<div class="col-lg-10">
							<div class="card">
								<div class="card-body">
									<div class="container" style="padding-top: 0%; padding-left: 5%">
										<ul id="myTab" class="nav nav-tabs">
											<li class="nav-item"><a href="#tab1" class="nav-link  active" data-toggle="tab">体能</a></li>
											<li class="nav-item"><a href="#tab2" class="nav-link" data-toggle="tab">打卡</a></li>
											<!--li class="nav-item"><a href="#tab3" class="nav-link" data-toggle="tab">Tab3</a></li-->
										</ul>

										<div id="myTabContent" class="tab-content">
											<div class="tab-pane active" id="tab1" style="height: 200px">
												<div id="tab1-container" class="myTable-container"></div>
											</div>
											<div class="tab-pane" id="tab2" style="height: 200px">
												<div id="tab2-container" class="myTable-container"></div>
											</div>
											<!--div class="tab-pane " id="tab3">
												<div id="tab3-container" class="myTable-container"></div>
											</div-->
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-md-2">
							<div class="card text-center">
								<div class="m-t-10">
									<p>Customer Feedback</p>
									<h5>385749</h5>
								</div>
								<div class="widget-card-circle pr m-t-20 m-b-20" id="info-circle-card">
									<i class="ti-control-shuffle pa"></i>
								</div>
								<ul class="widget-line-list m-b-15">
									<li class="border-right">92% <br><span class="color-success"><i class="ti-hand-point-up"></i> Positive</span></li>
									<li>8% <br><span class="color-danger"><i class="ti-hand-point-down"></i>Negative</span></li>
								</ul>
							</div>
						</div>
					</div>
				</section>
			</div>
        </main>
    </div>
</div>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script type="text/javascript" src="asserts/js/jquery-3.2.1.slim.min.js"
		th:src="@{/webjars/jquery/3.5.1/jquery.js}"></script>
<script type="text/javascript" src="asserts/js/popper.min.js"
		th:src="@{/webjars/popper.js/1.11.1/dist/popper.js}"></script>
<script type="text/javascript" src="asserts/js/bootstrap.min.js"
		th:src="@{/webjars/bootstrap/4.5.2/js/bootstrap.js}"></script>

<!-- Icons -->
<script type="text/javascript" src="asserts/js/feather.min.js" th:src="@{/asserts/js/feather.min.js}"></script>
<!-- Graphs -->
<script type="text/javascript" th:src="@{/webjars/echarts/4.7.0/dist/echarts.js}"></script>
<script src="asserts/js/theme/macarons.js"></script>
<script src="asserts/js/theme/wonderland.js"></script>
<script>
    feather.replace()
</script>
<script  type="text/javascript" th:inline="javascript">
	//init data
	var $tab1 = document.getElementById('tab1-container');
	var $tab2 = document.getElementById('tab2-container');
	var traceMap = new Map(Object.entries([[${details.traceCalendar}]]));
	var postMap = new Map(Object.entries([[${details.postCalendar}]]))
	var traceData = [];
	var postData = [];
	traceMap.forEach(function (value, key) {
		traceData.push([key, value]);
	});
	postMap.forEach(function (value, key) {
		postData.push([key, value]);
	});
	var cur = new Date();
	var range = cur.getFullYear().toString();

	/* 体能热力图 */
	var tab1Option = {
		tooltip: {
			formatter: function (params) {
				return params.value[0] + "体能" + params.value[1] + "人"
			},
		},
		visualMap: {
			min: 0,
			max: 15,
			type: 'piecewise',
			orient: 'horizontal',
			left: 'center',
			top: 160,
			textStyle: {
				color: '#000'
			}
		},
		calendar: {
			top: 40,
			left: 30,
			right: 30,
			cellSize: ['auto', 13],
			range: range,
			itemStyle: {
				borderWidth: 0.5
			},
			yearLabel: {show: false}
		},
		series: {
			type: 'heatmap',
			coordinateSystem: 'calendar',
			data: traceData
		}
	};

	/* 打卡热力图 */
	var tab2Option = {
		tooltip: {
			formatter: function (params) {
				return params.value[0] + "打卡" + params.value[1] + "人"
			},
		},
		visualMap: {
			min: 0,
			max: 15,
			type: 'piecewise',
			orient: 'horizontal',
			left: 'center',
			top: 160,
			textStyle: {
				color: '#000'
			}
		},
		calendar: {
			top: 40,
			left: 30,
			right: 30,
			cellSize: ['auto', 13],
			range: range,
			itemStyle: {
				borderWidth: 0.5
			},
			yearLabel: {show: false}
		},
		series: {
			type: 'heatmap',
			coordinateSystem: 'calendar',
			data: postData
		}
	};

	/* 初始化tab1的 */
	var tab1Table = echarts.init($tab1, "macarons");
	tab1Table.setOption(tab1Option);

	/* shown.bs.tab为tab选项卡高亮 */
	$('a[data-toggle="tab"]').on('shown.bs.tab', function(e) {
		/* 获取已激活的标签页的名称 */
		/* hash 属性是一个可读可写的字符串，该字符串是 URL 从 # 号开始的部分 */
		var activeTab = $(e.target)[0].hash;
		/* 当相应的标签被点击时，进行对应的图表渲染 */
		if (activeTab == "#tab2") {
			/* 释放图表实例，使实例不可用,不加上这个，会报错： */
			/* there is a chart instance     already initialized on the dom */
			echarts.dispose($tab2);
			var tab2Table = echarts.init($tab2, "wonderland");
			tab2Table.setOption(tab2Option);
		}
	});
</script>
</body>
</html>